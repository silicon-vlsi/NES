v {xschem version=3.4.8RC file_version=1.2}
G {}
K {}
V {}
S {}
E {}
N 1360 -1410 1840 -1410 {lab=VDD}
N 1840 -1410 1860 -1410 {lab=VDD}
N 1040 -1250 1040 -1190 {lab=#net1}
N 1040 -1190 1040 -1120 {lab=#net1}
N 1080 -1020 1100 -1020 {lab=#net1}
N 1040 -840 1040 -820 {lab=GND}
N 1040 -990 1040 -900 {lab=#net2}
N 1040 -1120 1040 -1050 {lab=#net1}
N 1100 -1080 1100 -1020 {lab=#net1}
N 1040 -1080 1100 -1080 {lab=#net1}
N 1040 -820 1040 -790 {lab=GND}
N 1080 -920 1080 -870 {lab=#net2}
N 1040 -920 1080 -920 {lab=#net2}
N 1040 -790 1040 -750 {lab=GND}
N 1040 -1320 1040 -1310 {lab=#net3}
N 1080 -1350 1080 -1280 {lab=#net4}
N 1040 -1400 1040 -1380 {lab=VDD}
N 1040 -1410 1040 -1400 {lab=VDD}
N 1040 -1190 1100 -1190 {lab=#net1}
N 1040 -1410 1360 -1410 {lab=VDD}
N 1080 -1310 1280 -1310 {lab=#net4}
N 1280 -1310 2070 -1310 {lab=#net4}
N 1140 -1310 1140 -1220 {lab=#net4}
N 1140 -1160 1140 -750 {lab=GND}
N 2110 -1280 2110 -1080 {lab=ra1}
N 2110 -820 2110 -730 {lab=GND}
N 2070 -850 2070 -750 {lab=GND}
N 2070 -750 2110 -750 {lab=GND}
N 1860 -1410 2110 -1410 {lab=VDD}
N 2580 -850 2580 -810 {lab=#net5}
N 2580 -760 2580 -740 {lab=#net6}
N 2520 -880 2560 -880 {lab=GND}
N 2520 -880 2520 -620 {lab=GND}
N 2520 -710 2560 -710 {lab=GND}
N 2520 -790 2560 -790 {lab=GND}
N 2580 -1010 2580 -910 {lab=vref}
N 2350 -1410 2350 -1340 {lab=VDD}
N 2110 -1410 2350 -1410 {lab=VDD}
N 2350 -1280 2350 -1080 {lab=vref}
N 2350 -1000 2350 -900 {lab=QP3}
N 2350 -840 2350 -730 {lab=GND}
N 2310 -870 2310 -770 {lab=GND}
N 2310 -770 2350 -770 {lab=GND}
N 2070 -1310 2310 -1310 {lab=#net4}
N 2110 -1410 2110 -1400 {lab=VDD}
N 2560 -1320 2690 -1320 {lab=ra1}
N 1400 -810 1400 -750 {lab=GND}
N 1360 -840 1360 -770 {lab=GND}
N 1360 -770 1400 -770 {lab=GND}
N 2620 -1340 2620 -1320 {lab=ra1}
N 2580 -1290 2580 -1130 {lab=GND}
N 2560 -1190 2560 -1160 {lab=QP2}
N 2580 -680 2580 -650 {lab=#net7}
N 2520 -620 2560 -620 {lab=GND}
N 2580 -590 2800 -590 {lab=#net8}
N 2110 -1000 2110 -880 {lab=QP2}
N 1400 -950 1400 -940 {lab=v_ctat}
N 1400 -880 1400 -870 {lab=#net9}
N 1640 -1470 1640 -1410 {lab=VDD}
N 1640 -1310 1640 -1240 {lab=#net4}
N 1730 -1410 1730 -1070 {lab=VDD}
N 1700 -1310 1700 -1140 {lab=#net4}
N 1690 -1000 1690 -950 {lab=ra1}
N 1690 -950 1960 -950 {lab=ra1}
N 1600 -1000 1600 -950 {lab=v_ctat}
N 1400 -950 1600 -950 {lab=v_ctat}
N 1510 -1080 1550 -1080 {lab=GND}
N 1510 -1080 1510 -900 {lab=GND}
N 1400 -1410 1400 -1340 {lab=VDD}
N 1400 -1280 1400 -950 {lab=v_ctat}
N 1330 -1310 1360 -1310 {lab=#net4}
N 2030 -1310 2070 -1310 {lab=#net4}
N 3010 -670 3010 -650 {lab=#net10}
N 3010 -750 3010 -730 {lab=#net11}
N 3010 -840 3010 -810 {lab=#net12}
N 2990 -780 2990 -620 {lab=GND}
N 2990 -870 2990 -780 {lab=GND}
N 2960 -620 2990 -620 {lab=GND}
N 2800 -590 3010 -590 {lab=#net8}
N 3030 -1020 3030 -990 {lab=QP3}
N 2560 -1260 2560 -1250 {lab=#net13}
N 2940 -930 3100 -930 {lab=#net14}
N 3010 -930 3010 -900 {lab=#net14}
N 2920 -960 3080 -960 {lab=GND}
N 2990 -960 2990 -870 {lab=GND}
N 2940 -990 3100 -990 {lab=QP3}
C {iopin.sym} 1640 -1470 0 0 {name=p1 lab=VDD}
C {lab_wire.sym} 1040 -750 0 0 {name=p13 sig_type=std_logic lab=GND}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 1060 -1350 0 1 {name=M11
W=5
L=1
body=VDD
nf=1
mult=1
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 1060 -1280 0 1 {name=M12
W=5
L=1
body=VDD
nf=1
mult=1
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 1120 -1190 0 0 {name=M13
W=5
L=1
body=VDD
nf=1
mult=2
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet3_01v8_lvt.sym} 1060 -870 0 1 {name=MN3
W=1
L=7
body=GND
nf=1
mult=1
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet3_01v8_lvt.sym} 1060 -1020 0 1 {name=MN4
W=1
L=7
body=GND
nf=1
mult=1
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 1140 -750 0 0 {name=p11 sig_type=std_logic lab=GND}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 2090 -1310 0 0 {name=M15
W=5
L=2
body=VDD
nf=1
mult=2
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/res_high_po_1p41.sym} 2560 -1290 2 0 {name=R3
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {iopin.sym} 2580 -1130 2 1 {name=p18 lab=GND
}
C {lab_wire.sym} 2620 -1340 0 0 {name=p12 sig_type=std_logic lab=ra1}
C {lab_wire.sym} 2560 -1160 0 0 {name=p14 sig_type=std_logic lab=QP2}
C {sky130_fd_pr/pnp_05v5.sym} 2090 -850 0 0 {name=Q2
model=pnp_05v5_W3p40L3p40
m=8
spiceprefix=X
}
C {lab_wire.sym} 2110 -1080 0 0 {name=p15 sig_type=std_logic lab=ra1}
C {lab_wire.sym} 2110 -1000 0 0 {name=p16 sig_type=std_logic lab=QP2}
C {lab_wire.sym} 2110 -730 0 0 {name=p17 sig_type=std_logic lab=GND}
C {sky130_fd_pr/res_high_po_1p41.sym} 2580 -880 0 0 {name=R5
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 2580 -790 0 0 {name=R6
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 2580 -710 0 0 {name=R7
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {lab_wire.sym} 2520 -760 0 0 {name=p19 sig_type=std_logic lab=GND}
C {lab_wire.sym} 2580 -1010 0 0 {name=p22 sig_type=std_logic lab=vref}
C {lab_wire.sym} 3030 -1020 0 0 {name=p23 sig_type=std_logic lab=QP3}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 2330 -1310 0 0 {name=M2
W=5
L=2
body=VDD
nf=1
mult=4
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 2350 -1080 0 0 {name=p2 sig_type=std_logic lab=vref}
C {lab_wire.sym} 2350 -1000 0 0 {name=p6 sig_type=std_logic lab=QP3}
C {sky130_fd_pr/pnp_05v5.sym} 2330 -870 0 0 {name=Q5
model=pnp_05v5_W3p40L3p40
m=1
spiceprefix=X
}
C {lab_wire.sym} 2350 -730 0 0 {name=p24 sig_type=std_logic lab=GND}
C {vsource.sym} 2110 -1370 0 0 {name=V9 value=0 savecurrent=false}
C {code_shown.sym} 2990 -1660 0 0 {name=s1 only_toplevel=false value=".title BGR_opamp
.lib /home/somya/share/pdk/sky130A/libs.tech/ngspice/sky130.lib.spice tt
.temp 27
.global VDD GND
*.dc vin 0 1.8 0.01
.save all

vsup    VDD     GND     dc      2
.dc temp -40 125 5

*vsup   vdd     gnd     pulse   0       2       10n     1u      1u      1m      100u
*.tran  5n      10u

.control
run
*meas dc VREF_MIN MIN v(vref)
*meas dc VREF_NOM FIND v(vref) AT=27
plot v(vref)

plot v(v_ctat) v(vref) - v(QP3)
*plot v(QP2) 
*plot v(ra1) - v(QP2)

*plot i(V1) i(V9)
 
*PLOT v(M7gate) v(ra1) v(QP2)
*plot vid1#branch vid2#branch vid3#branch vid4#branch vid5#branch
*plot i(V1) i(V2) i(V3) i(V8) i(V9)
.endc
.end
"}
C {opamp.sym} 1640 -1080 1 1 {name=x1}
C {lab_wire.sym} 1510 -900 0 0 {name=p3 sig_type=std_logic lab=GND}
C {lab_wire.sym} 1960 -950 0 0 {name=p4 sig_type=std_logic lab=ra1}
C {sky130_fd_pr/pnp_05v5.sym} 1380 -840 0 0 {name=Q1
model=pnp_05v5_W3p40L3p40
m=1
spiceprefix=X
}
C {lab_wire.sym} 1400 -750 0 0 {name=p5 sig_type=std_logic lab=GND}
C {sky130_fd_pr/res_high_po_1p41.sym} 2560 -1220 2 0 {name=R10
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 2580 -620 0 0 {name=R8
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {lab_wire.sym} 1400 -950 0 0 {name=p7 sig_type=std_logic lab=v_ctat}
C {vsource.sym} 1400 -910 0 0 {name=V1 value=0 savecurrent=false}
C {sky130_fd_pr/pfet3_01v8_lvt.sym} 1380 -1310 0 0 {name=M1
W=5
L=2
body=VDD
nf=1
mult=2
ad="expr('int((@nf + 1)/2) * @W / @nf * 0.29')"
pd="expr('2*int((@nf + 1)/2) * (@W / @nf + 0.29)')"
as="expr('int((@nf + 2)/2) * @W / @nf * 0.29')"
ps="expr('2*int((@nf + 2)/2) * (@W / @nf + 0.29)')"
nrd="expr('0.29 / @W ')" nrs="expr('0.29 / @W ')"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/res_high_po_1p41.sym} 3010 -620 0 0 {name=R16
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 3010 -700 0 0 {name=R17
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 3010 -780 0 0 {name=R18
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 3010 -870 0 0 {name=R19
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {lab_wire.sym} 2960 -620 0 0 {name=p10 sig_type=std_logic lab=GND}
C {sky130_fd_pr/res_high_po_1p41.sym} 2940 -960 0 0 {name=R1
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
C {sky130_fd_pr/res_high_po_1p41.sym} 3100 -960 0 0 {name=R2
L=7.58
model=res_high_po_1p41
spiceprefix=X
mult=1}
